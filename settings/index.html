<!DOCTYPE html>
<html>
<head>
    <!-- The '/homey.js' script must be included in your settings view to work -->
    <script type="text/javascript" src="/homey.js" data-origin="settings"></script>
    <script src='https://cdn.staticaly.com/gh/robertklep/homey-mocks/v0.0.7/homey-settings-mock.js'></script>

    <link href="style.css" rel="stylesheet" type="text/css">
    <link href="assets/css/homey.css" rel="stylesheet" type="text/css">
    <link href="homeyExtras.css" rel="stylesheet" type="text/css">
</head>

<body>
<div class="tab">
    <button class="tab-links hy-nostyle" data-i18n="settings.settings" data-target="settings" id="defaultOpen">
        Settings
    </button>
    <button class="tab-links hy-nostyle" data-i18n="settings.users" data-target="users">Users</button>
    <button class="tab-links hy-nostyle" data-i18n="settings.questions" data-target="questions">Questions</button>
    <button class="tab-links hy-nostyle" data-i18n="settings.logs" data-target="logs">Logs</button>
</div>

<div id="settings" class="tab-content">
    <div class="tab-container">
        <div class="status not-running" id="running-status"></div>
        <div class="homey-form-group mb-2 mt-0-5">
            <label class="homey-form-label mt-0-5" data-i18n="settings.token" for="bot-token">Bot Token</label>
            <input class="homey-form-input" id="bot-token" type="text" value=""/>
        </div>
        <label class="homey-form-checkbox mt-0 mb-1">
            <input class="homey-form-checkbox-input" id="usePassword" name="checkbox-example" onclick="togglePassword()"
                   type="checkbox"/>
            <span class="homey-form-checkbox-checkmark"></span>
            <span class="homey-form-checkbox-text" data-i18n="settings.passwordEnable">Enable Password</span>
        </label>
        <div class="hidden mb-1" id="usePasswordDiv">
            <label class="homey-form-label mt-0-5" data-i18n="settings.password" for="bot-password">Bot Password</label>
            <input class="homey-form-input" id="bot-password" type="password" value=""/>
            <p data-i18n="settings.userInfoPassword" style="margin-bottom: 0; margin-top: 5px">To Register a user/chat
                now
                you have to
                enter /start [yourPassword] to the bot via Telegram</p>
        </div>
        <button class="homey-button-primary-full" data-i18n="settings.save" id="save" onclick="onSaveToken()">Save
            changes
        </button>
    </div>
    <div class="tab-container">
        <header class="homey-header  mb-2">
            <p class="homey-title" data-i18n="settings.howToSetup.title">
                How to setup
            </p>
        </header>
        <ol>
            <li data-i18n="settings.howToSetup.step1">Set up your own Telegram bot. This is fully secure and private,
                since
                you are the only one who can access
                the message archive. Enter&nbsp;<strong><span class="mention"><a href="https://t.me/botfather">@Botfather</a></span></strong>&nbsp;in
                the search
                tab of&nbsp;<strong>Telegram</strong>&nbsp;and choose the&nbsp;<strong><span
                        class="mention"><a href="https://t.me/botfather">@Botfather</a></span></strong>&nbsp;bot.
            </li>
            <li data-i18n="settings.howToSetup.step2">Click &ldquo;Start&rdquo; to activate&nbsp;<strong><span
                    class="mention"><a href="https://t.me/botfather">@Botfather</a></span></strong>&nbsp;bot
                or enter&nbsp;<code>/newbot</code>.&nbsp;<br/><code>/setjoingroup </code>disables that the bot is
                allowed to
                join a group.<br/><code>/setprivacy</code>&nbsp;disabels that the bot can read messages inside a group
            </li>
            <li data-i18n="settings.howToSetup.step3">Enter the Token inside the app settings</li>
            <li data-i18n="settings.howToSetup.step4">Write your bot over Telegram&nbsp;<code>/start</code>&nbsp;and
                follow
                the instructions<br/>Each user has to
                also send the Bot the&nbsp;<code>/start</code>&nbsp;command. You can share the Bot via Telegram over the
                profile or search for the like you searched for the BotFather bot.
            </li>
        </ol>
    </div>
</div>

<div id="users" class="tab-content">
    <div class="tab-container">
        <header class="homey-header  mb-2">
            <p class="homey-title" data-i18n="settings.users">
                Users
            </p>
        </header>
        <div class="users" id="users-list">
        </div>
    </div>
    <div class="tab-container">
        <header class="homey-header  mb-2">
            <p class="homey-title" data-i18n="settings.clearAll">
                Clear all users
            </p>
        </header>
        <p data-i18n="settings.userInfo">When you clear the users you have to re-register the
            users to the Telegram bot.
            This means you have to send the /start command again.</p>
        <button class="homey-button-danger-full" data-i18n="settings.clear" id="clear" onclick="clearAllUsers()"
                style="width: 100%">Clear
            users
        </button>
    </div>
</div>

<div id="questions" class="tab-content">
    <div class="tab-container">
        <header class="homey-header  mb-2">
            <p class="homey-title" data-i18n="settings.questions">
                Questions
            </p>
        </header>
        <div id="question-list">
            No questions setup :(
        </div>
    </div>
    <div class="tab-container" id="question-add-field">
        <header class="homey-header  mb-2">
            <p class="homey-title" data-i18n="settings.addQuestion">
                Add question
            </p>
        </header>
        <div class="homey-form-group mt-0  mb-0">
            <label class="homey-form-label mt-0" for="question-name" data-i18n="settings.question">Question</label>
            <input class="homey-form-input mb-0" id="question-name" type="text"
                   placeholder="Do you want to close the shutters?" value=""/>
        </div>
        <div class="row" style="margin-top: .5em;margin-bottom: 0.25em;">
            <h2 data-i18n="settings.answers">Answers</h2>
            <button onclick="createNewInputField()" class="homey-button-small right"
                    data-i18n="settings.addAnswerButton">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        <div class="row" style="margin-bottom: .5em">
            <h3 data-i18n="settings.keepAnswers">Keep answers</h3>
            <label class="switch right">
                <input type="checkbox" id="question-answer-keep-answers">
                <span class="slider round"></span>
            </label>
        </div>
        <div class="row" style="margin-bottom: .5em">
            <h3 data-i18n="settings.silentQuestion">Silent question</h3>
            <label class="switch right">
                <input type="checkbox" id="question-silent-question">
                <span class="slider round"></span>
            </label>
        </div>
        <div class="row" style="margin-bottom: .5em">
            <h3 data-i18n="settings.columns" style="width: 90%">Buttons per Row</h3>
            <span id="columnSizeDisplay" style="padding-right: 5px">2</span>
            <input id="columnSize" max="4" min="1" oninput="let onInput = () =>  {
              document.getElementById('columnSizeDisplay').innerHTML = document.getElementById('columnSize').value;
            }; onInput()" type="range" value="2">
        </div>
        <div class="col" id="question-answer-col">
        </div>
        <button class="homey-button-primary-full" id="addQuestion" onclick="addQuestion()"
                data-i18n="settings.saveQuestion" style="margin-top: .5em">Save question
        </button>
    </div>

    <div class="hidden tab-container" id="question-edit-field">
        <header class="homey-header mb-2">
            <p class="homey-title" data-i18n="settings.editQuestion">
                Edit question
            </p>
        </header>
        <button id="hideEditQuestion" class="homey-button-small-gray-full" onclick="toggleEditField(false)"
                data-i18n="settings.hideEditQuestion" style="width: 100%;">Hide Edit mode
        </button>
        <div class="homey-form-group mt-0 mb-0">
            <label class="homey-form-label mt-1" for="question-uuid-edit">UUID</label>
            <input class="homey-form-input" id="question-uuid-edit" disabled type="text" value=""/>
            <label class="homey-form-label mt-1" for="question-name-edit" data-i18n="settings.question">Question</label>
            <input class="homey-form-input" id="question-name-edit" type="text"
                   placeholder="Do you want to close the shutters?" value=""/>
        </div>

        <div class="row" style="margin-top: .5em;margin-bottom: 0.25em;">
            <h2 data-i18n="settings.answers">Answers</h2>
            <button onclick="createNewInputFieldForEdit()" class="homey-button-small right">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        <div class="row" style="margin-bottom: .5em">
            <h3 data-i18n="settings.keepAnswers">Keep answers</h3>
            <label class="switch right">
                <input type="checkbox" id="question-answer-edit-keep-answers">
                <span class="slider round"></span>
            </label>
        </div>
        <div class="row" style="margin-bottom: .5em">
            <h3 data-i18n="settings.silentQuestion">Silent question</h3>
            <label class="switch right">
                <input type="checkbox" id="question-silent-question-edit">
                <span class="slider round"></span>
            </label>
        </div>
        <div class="row" style="margin-bottom: .5em">
            <h3 data-i18n="settings.columns" style="width: 90%">Buttons per Row</h3>
            <span id="columnSizeDisplayEdit" style="padding-right: 5px">2</span>
            <input id="columnSizeEdit" max="4" min="1" oninput="let onInput = () =>  {
              document.getElementById('columnSizeDisplayEdit').innerHTML = document.getElementById('columnSizeEdit').value;
            }; onInput()" type="range" value="2">
        </div>
        <div class="col" id="question-answer-edit-col"></div>
        <button id="editQuestion" onclick="editQuestion()" data-i18n="settings.saveEditQuestion"
                class="homey-button-primary-full" style="margin-top: .5em">Edit question
        </button>
    </div>

    <div class="tab-container">
        <header class="homey-header  mb-2">
            <p class="homey-title" data-i18n="settings.questionSetup.title">
                How to use the question system
            </p>
        </header>
        <ol>
            <li><p data-i18n="settings.questionSetup.step1" style="margin-bottom: 0">Set up a question with the add a
                question feature.</p>
                <ol style="margin-bottom: 0">
                    <li data-i18n="settings.questionSetup.step1-1">Enter a question e.g. 'Do you like pizza?</li>
                    <li data-i18n="settings.questionSetup.step1-2">Enter any amount of answers below</li>
                    <li data-i18n="settings.questionSetup.step1-3">Save the question</li>
                </ol>
            </li>
            <li data-i18n="settings.questionSetup.step2">Send this question to your telegram via the "Send a question"
                THEN-flowcard
            </li>
            <li data-i18n="settings.questionSetup.step3">Add a "A Question has been answered" WHEN-flowcard</li>
            <li data-i18n="settings.questionSetup.step4">Use the token of the card to make your favorite flow!</li>
        </ol>
    </div>
</div>

<div class="tab-content tab-container" id="logs">
    <div class="row" style="margin-bottom: .5em">
        <h3 data-i18n="settings.debugLogs">Enable Debug logs</h3>
        <label class="switch right">
            <input type="checkbox" id="debug-logs" onchange="updateLogs()">
            <span class="slider round"></span>
        </label>
    </div>
    <hr>
    <textarea class="logs-list homey-form-textarea" id="logs-list"></textarea>
    <button class="homey-button-primary-full" data-i18n="settings.clearLogs" id="clearLogs" onclick="clearLogs()"
            style="margin-top: .5em">Clear Logs
    </button>
</div>

<script type="text/javascript" src="index.js"></script>
</body>
</html>
